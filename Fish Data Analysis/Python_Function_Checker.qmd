---
title: "Python_Function_Checker"
format: html
editor: visual
---

This code is so that I can graph things and check the sanity of some of the numbers I'm getting from python

god help me

```{r}
library(MASS)
library(tidyverse)
library(ggplot2)
library(bbmle) #For ICtab
library(car)
library(ggpubr)
library(ggdist)
library(emmeans)
library(lme4)
library(viridis)
```

```{r}
rad2deg <- function(rad) {(rad * 180) / (pi)}
deg2rad <- function(deg) {(deg * pi) / (180)}
round_any <- function(x, accuracy, f=round){f(x/ accuracy) * accuracy}
ang_mean <- function(x){rad2deg(atan2(mean(sin(deg2rad(x))),mean(cos(deg2rad(x)))))}

fold_angle_0_360_to_0_180 <- function(x){abs(abs(x-180)-180)}

fold_angle_neg_180_180_to_neg_90_90 <- function(x){ifelse(x > 90,90-abs(90-x),ifelse(x < -90, -90+abs(-90-x), x))}

min_n <- function(x,n){sort(x)[1:n]}
max_n <- function(x,n){sort(x,decreasing = TRUE)[1:n]}

light_no_ab_color = "#d4d7dd"
light_ab_color = "#f5ba9e"
dark_no_ab_color = "#5e94d4"
dark_ab_color = "#1E4371"
sim_color = "#777777"

flow_split_still = "#F59DE2"
flow_split_flow = "#5DD492"

dark_split_light = "#5e94d4"
dark_split_dark = "#011627"

tailbeat_len = 19

allowed_flow_type = c("Still Water","Flowing Water (2 BL/s)")

dot_binwidth = 0.03

text_size = 16
```

Checking Yaw heading to Yaw heading per second
```{r}

yaw_heading <- c(-167.54459672, -164.00687462, -168.98414205, -166.61836788, -167.78762181, -166.70097362, -165.29525395, -165.30218133,                               -164.58822264, -163.3408287 , -161.61681439, -161.86290475, -161.3457678 , -160.83045602, -159.62636679, -159.33372869,
                 -159.73135763, -159.90182562, -160.30500354, -161.66789667, -162.51319698, -162.79636523, -162.74225263, -162.9287712 ,
                 -163.60032788, -165.81108204, -166.11093243, -164.97574064, -165.21863337, -167.25169657, -168.12792965, -168.20367058, 
                 -167.67180831, -166.19304209, -163.49109648, -159.19325321, -159.53053155, -158.25531792, -160.67456563, -161.84596453,
                 -164.62263832, -165.43424489, -162.72534771, -164.01374268, -161.91007054, -157.10197197, -152.13376557, -140.09755059,
                 -117.36633413,  -70.43161492,  -47.9456764 ,  -29.21365197, -23.75447313,  -18.17521677,  -16.32436529,  -14.93402239,
                 -15.08093262,  -13.26702467,  -14.00153725,  -14.86879625, NA,           NA,           NA,           NA,
                 NA,           NA,           NA,           NA, NA,           NA,           NA,           NA,
                 NA,           NA,           NA,           NA, NA,           NA,           NA,           NA,
                 NA,           NA,   14.32422844,   13.39335743, 15.92634947,   16.16110754,           NA,           NA,
                 NA,           NA,           NA,           NA, 44.99550798,   44.48982227,   36.38171854,   41.31813581,
                 40.95270795,   42.24809671,   46.1309454 ,   44.05042164, 42.71920711,   42.35480939,   44.98274954,   44.84775282,
                 43.29644761,   43.23330227,   47.02605662,   46.85754598, 51.77293318,   53.28608349,   52.16950759,   52.80564698,
                 55.78471615,   61.73291478,   66.96283784,   72.14740014,
         84.66596762,   89.74602772,   98.93621811,   99.55452549,
        104.85523277,  106.61721161,  107.40770175,  109.64418461,
        111.47219863,  111.35847397,  111.08904672,  111.29568776,
        113.00056342,  114.45399063,  118.1206579 ,  119.39466382,
        121.95913431,  125.1159197 ,  127.53885325,  130.11307582,
        132.43692078,  135.47448731,  139.73964557,  141.77307431,
        143.81390772,  146.23957442,  149.64506539,  150.91555524,
        153.15996897,  153.85978103,  155.49863644,  157.32133187,
        156.87419762,  154.96461911,  154.82076825,  156.23920712,
        156.88692458,  156.00812781,  156.64301914,  157.39117126,
        156.11425145,  156.2949576 ,  156.67140617,  155.89931891,
        156.26657932,  157.31722099,  157.63047699,  157.72404347,
        157.76041307,  158.2493288 ,  156.63886235,  157.80914353,
        156.05386627,  158.09745731,  160.40467074,  162.75863225,
        163.66876967,  165.19773852,  166.7199738 ,  164.98996497,
        165.28115879,  167.62582273,  166.01133552,  168.50763579,
        170.4498241 ,  173.23196272,  172.1170309 ,  170.43486562,
        170.72564221,  169.55169964,  167.76171477,  168.8015576 ,
        169.12759313,  169.66611452,  168.69088031,  169.90093323,
        168.28220527,  167.85927435,  169.25747305,           NA,
                 NA,           NA,           NA,           NA,
                 NA,           NA,  174.23926662,           NA,
                 NA,           NA,           NA,           NA,
                 NA,           NA,           NA,           NA,
                 NA,           NA,           NA,           NA,
                 NA,           NA,           NA,           NA,
                 NA,           NA,           NA,           NA,
                 NA,           NA,           NA,           NA,
                 NA,           NA,           NA,           NA,
                 NA,           NA,           NA,           NA,
                 NA,           NA,           NA,           NA,
                 NA, -179.49106278, -178.96147702, -175.89473399,
       -175.08765244, -174.72397485, -175.65755899, -177.07511847,
       -177.68671104, -179.37515617, -179.8608891 , -179.10997591,
       -176.6709492 , -175.42196113, -172.53584266, -171.08128596,
       -169.39424269, -169.37235121, -169.10448836, -164.52247162,
       -158.00995215, -163.97303337, -164.51612283, -165.11342739,
       -163.09365519, -164.82417507, -165.48517236, -166.27051732,
       -163.70387209, -163.87313467, -162.56502293, -163.50651289,
       -161.97489362, -164.92893187, -163.85354209, -166.76958781,
       -167.16111166, -167.72356078, -166.61595468, -168.97448724,
       -167.33073179, -169.87582908, -172.00964687, -170.10720127,
       -170.41510513, -172.83009274, -168.89230439, -167.18382984,
       -168.82229943)

yaw_heading_chunked <- c(-2.85198125, -2.86260044, -1.7855753 , -0.24514521,  0.46294108,
        0.82450266,  1.81209534,  2.54041381,  2.74279524,  2.93273097,
        2.9619111 ,         NA, -3.08288111, -2.9769271 , -2.90564693)

yaw_heading_PS <- c(1833.01679654, 4499.07412556, 3864.91495963, 1838.58926068,
       2319.02536418, 2949.43400219, 1599.7552887 ,  674.34353667,
        376.63241152,           NA,  409.76754369,           NA,
        304.64311747)
```

```{r}

raw_heading_data <- tibble("yaw_heading" = yaw_heading,
                           "Frame" = seq(1:length(yaw_heading)))

chunked_heading_data <- tibble("yaw_heading_chunked" = rad2deg(yaw_heading_chunked),
                           "Frame" = seq(1:length(yaw_heading_chunked))*tailbeat_len)

heading_PS_data <- tibble("yaw_heading_PS" = yaw_heading_PS / 60,
                           "Frame" = (seq(1:length(yaw_heading_PS))+0.5)*tailbeat_len)

```


```{r}

ggplot()+
  geom_point(aes(Frame, yaw_heading), data = raw_heading_data)+
  geom_point(aes(Frame, yaw_heading_chunked), data = chunked_heading_data, color = "red")+
  theme_classic()

ggplot()+
  geom_point(aes(Frame, yaw_heading_PS), data = heading_PS_data, color = "blue")+
  theme_classic()

```
well this all seems to track at least
